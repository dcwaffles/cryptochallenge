<!doctype html>
<html lang="en">

<head>
   <style>
      table {
      font-family: arial, sans-serif;
      border-collapse: collapse;
      width: 100%;
      }
      td, th {
      border: 1px solid #dddddd;
      text-align: left;
      padding: 8px;
      }
      tr:nth-child(even) {
      background-color: #dddddd;
      }
   </style>
   
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">

    <title>Crypto Challenge</title>


</head>
<meta http-equiv="refresh" content="300">
<body ng-app="myapp" ng-controller="tableController">
    <h1>Coin Tracker</h1>

    <table class="table table-stripe">
        <thead>
            <tr>
                <th>Name</th>
                <th>Ticker</th>
                <th> Starting BTC </th>
                <th> Current BTC </th>
                <th> %CHANGE </th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="c in challengers">
                <td> {{c.Name }}</td>
                <td> {{ c.Ticker }} </td>
                <td> {{ c.StartBtc }} </td>
                <td> {{ c.CurrentBtc }} </td>
				<td> {{ c.Change}}% </td> 
            </tr>
        </tbody>
    </table>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js" integrity="sha384-a5N7Y/aK3qNeh15eJKGWxsqtnX/wWdSZSKp+81YjTmS15nvnvxKHuzaWwXHDli+4" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script type="text/javascript">
        var app = angular.module("myapp", []);
        app.controller("tableController", ['$scope', '$http', function($scope, $http) {

            var challengers = [{
                'Name': 'Kalpesh Khatri',
                'Ticker': 'Ethereum-Classic',
                'StartBtc': 0.00246375,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'James Banner',
                'Ticker': 'Digibyte',
                'StartBtc': 0.00000747,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'Tim Hegh',
                'Ticker': 'Ripple',
                'StartBtc': 0.00013168,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'Kim Tran',
                'Ticker': 'Qtum',
                'StartBtc': 0.00360578,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'Andrea Sodini',
                'Ticker': 'Substratum',
                'StartBtc': 0.00017278,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'David Chung',
                'Ticker': 'Utrust',
                'StartBtc': 0.00007302,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'Jack Parker',
                'Ticker': 'Bitcoin',
                'StartBtc': 1.00000000,
                'CurrentBtc': '0',
				'Change' :0,
            }, {
                'Name': 'Robert Patterson',
                'Ticker': 'Bread',
                'StartBtc': 0.00018388,
                'CurrentBtc': '0',
				'Change' :0,
            }];
			
			$scope.challengers = challengers;

            var promise = [];
            challengers.forEach(function(c) {
                promise.push(SetBtcPrice(c));
            });

         /*   Promise.all(promise).then(function() {		
                $scope.challengers = challengers;
            });
*/
		
            function SetBtcPrice(challenger) {

              return  $http.get("https://api.coinmarketcap.com/v1/ticker/" + challenger.Ticker + "/")
                    .then(function(response) {
                        challenger.CurrentBtc = response.data[0].price_btc;
						challenger.Change = (((challenger.CurrentBtc-challenger.StartBtc)/challenger.StartBtc)*100).toFixed(5);
                    });
            }
        }]);
    </script>
</body>

</html>
